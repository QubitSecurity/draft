# 필상 시스템 — Day 10 분석가 콘솔(UX) & 워크플로우

1. **날짜**

* 2025-08-19

2. **목표**

* **분석가 콘솔 정보구조(IA)**·핵심 화면·공통 컴포넌트 확정
* **3-클릭·10초** 내 증거 확인, **MTTR 30%↓**를 목표로 워크플로우 표준화

---

3. **내용**

### A. 정보구조(IA) & 네비게이션

* 상단 바: **Tenant/Region 스위처(KR/JP)** · 글로벌 타임피커(최근 15m/1h/24h) · 검색바
* 사이드: **Overview**, **Incidents**, **Search**, **DBV360**, **Rules**, **TI**, **Alerts**, **Settings**
* 퀵패널: **Saved Queries**(역할별), **Recent Incidents**, **Release Notes**(배포 상관 표시)

### B. 핵심 화면(요약)

1. **Overview**

   * 카드: 인입량·차단량·사건 추세·FP/Missed 비율·DLQ 큐 크기
   * 지도/히트맵: Region·AS 번호 분포(개인정보 마스킹 준수)
2. **Incidents**

   * 테이블: `severity, state, rule_id, dst_host, incident_key, last_seen`
   * 우측 **Evidence Viewer**: 원로그 해시, 샘플 10건, 파셋, TI 요약, 관련 릴리스/룰 변경 이력
3. **Search(고급)**

   * **템플릿 빌더**(파라미터식): *IP/URI/Rule/시간대*
   * 결과: 저장/공유/즐겨찾기, **쿼리 서명/승인(감사)**
4. **DBV360(판정)**

   * 블록/정상 샘플 비교, 판정 슬라이더(`allow↔review↔block`), 근거 Top-K
   * 판정 저장 시 **룰 델타 초안** 자동 생성(드래프트)
5. **Rules**

   * 채널(`alpha|beta|stable`) 뷰, **Diff 뷰어**, 샘플 영향도(히트율 변화)
6. **TI**

   * 평판 캐시 조회, 출처 링크, 신뢰도/최근 목격 수, **분쟁(override) 기록**
7. **Alerts**

   * SLO·보안·인프라 알람 스트림(소유자/티켓 연동)

### C. 공통 컴포넌트 & 상호작용

* **Global Filter Chip**: `tenant | region | time | dst_host | rule_id` (키보드 단축키 `/`, `g t` 등)
* **Evidence Viewer**:

  * **원본 보존 원칙**: Blob은 S3 URI만, 화면은 마스킹된 미리보기
  * 탭: *Raw/Parsed/Facets/TI/Related Changes*
* **Action Bar**(컨텍스트): *티켓 생성*, *룰 변경 초안*, *웹훅 재전송*, *재분석 요청*
* **컬럼 구성 저장**: 역할별 프로필(OWNER/ADMIN/ANALYST/READONLY)

### D. 성능·가용성 기준(프런트)

* 첫 페인트(FCP) ≤ **2.5s**, 상호작용 시간(TTI) ≤ **4s**, 주요 테이블 **p95 800ms**
* 실시간 스트림: SSE/WebSocket(개수 제한, 백오프)
* 오프라인 모드: 최근 조회 결과 **IndexedDB 30분 캐시**, 재시도 큐

### E. 접근성·국제화

* **i18n**: ko/ja/en 번들, 날짜·숫자 로캘 자동, **텍스트는 별도 리소스 관리**
* **a11y**: 키보드 포커스, ARIA 라벨, 명암 4.5:1 이상
* **감사/프라이버시**: 스크린샷 내 PII 자동 블러 옵션

### F. 보안·권한

* **토큰 스코프별 UI 가시성**(버튼/액션 제한), **RLS 필터 주입 표시**
* 다운로드는 **서명된 링크**+만료(10분), 감사 로그에 `actor, scopes, purpose` 기록
* **세션 보안**: 유휴 15m 경고, 30m 재인증, 탭 간 세션 동기화(mTLS 게이트웨이)

### G. API 연계(예시)

* `GET /v1/incidents?tenant_id=T1&cursor=…`
* `POST /v1/detect:adjudicate` (DBV360 수동)
* `GET /v1/search/saved?role=ANALYST`
* `POST /v1/rules/draft` (증거→룰 델타 생성)
* `POST /v1/notify/webhook:retry` (실패 알림 재전송)

### H. 운영/배포

* **프런트 엔드와 API 버전 독립**: *API Capabilities* 협상(서버 제공 플래그)
* **릴리스 가드**: Lighthouse·E2E·시각 회귀 테스트(Storybook + Chromatic)
* **피쳐 플래그**: 새 화면은 `beta_ui_console`로 점진 롤아웃

---

4. **예시 설명 (3-클릭 오탐 판정 & 룰 델타 배포)**

1) **Incidents** 목록에서 `severity=med`, 룰 `WAF-941100` 필터(클릭-1) → 사건 선택
2) 우측 **Evidence Viewer**에서 최근 24h **406/Blocked:1 vs 200 샘플** 비교(클릭-2)

   * TI 점수 낮음, 파라미터가 **URL 인코딩 한국어 검색어** → FP 의심
3) **DBV360** 탭에서 `review→allow` 판정 저장(클릭-3) → **룰 델타 초안** 자동 생성

   * Action Bar에서 “**드래프트 테스트**” → KR-stg Shadow → Canary 5% → 정상
   * 콘솔 상단 배너에 “룰 v8-beta 적용(히트율 -37%, FP율 -1.2%p)” 표기
   * 티켓 자동 **해결(Resolved)**, 릴리스 노트에 증거/변경 근거 링크 기록

> 결과: 분석가는 **3-클릭·10초 내** 증거 확인과 판정/룰 수정까지 일관 흐름을 수행, **MTTR 감소**와 **운영 품질 향상**을 동시에 달성.
